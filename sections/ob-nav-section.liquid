<nav class="shadow-md  relative hidden lg:block" x-data="{ open: false }">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 ">
        <div class="flex justify-between h-10 content-center z-20">
            <!-- Desktop menu items -->
            {% for link in section.settings.menu.links %}
                {%- comment %}<locksmith:51c8>{% endcomment -%}
                  {%- capture var %}{% render 'locksmith-variables', scope: 'subject', subject: link, subject_parent: section.settings.menu, variable: 'transparent' %}{% endcapture %}{% if var == "true" %}{% else %}{% continue %}{% endif -%}
                {%- comment %}</locksmith:51c8>{% endcomment -%}
                {% assign hasSubLinks = false %}
                {% if link.links.size > 0 %}
                    {% assign hasSubLinks = true %}
                {% endif %}
                {% assign hasSubSubLinks = false %}
                {% assign canHaveImage = false %}
                {% if hasSubLinks %}
                    {% for sublink in link.links %}
                        {%- comment %}<locksmith:5ea8>{% endcomment -%}
                          {%- capture var %}{% render 'locksmith-variables', scope: 'subject', subject: sublink, subject_parent: link, variable: 'transparent' %}{% endcapture %}{% if var == "true" %}{% else %}{% continue %}{% endif -%}
                        {%- comment %}</locksmith:5ea8>{% endcomment -%}
                        {% if sublink.links.size < 2 %}
                          {% assign canHaveImage = true %}
                        {% endif %}
                        {% if sublink.links.size > 0 %}
                            {% assign hasSubSubLinks = true %}
                            {% break %}
                        {% endif %}
                    {% endfor %}
                {% endif %}
                <div x-data="{ open: false }" @mouseenter="open = true" @mouseleave="open = false" class="inline-block text-left">
                    <button @click="open = !open" class="uppercase inline-flex items-center px-1 pt-1 border-b-2 border-transparent text-sm font-medium leading-5 text-gray-900 focus:outline-none focus:border-indigo-500 transition duration-150 ease-in-out">
                      {{ link.title }}
                    </button>
                    {% if hasSubLinks %}
                        <div x-show="open" x-cloak class="absolute left-0 z-10 mt-2 w-screen left-0 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5">
                          <div class="max-w-5xl w-full mx-auto py-4 ">
                            <div class="py-1 w-full flex justify-between">
                              
                              {% unless hasSubSubLinks %}<div class="no sublinks">{% endunless %}  
                              {% unless hasSubSubLinks %}<div class="font-bold px-4 py-2 uppercase">{{ link.title }}</div> {% endunless %}
                                {% for sublink in link.links %}
                                    
                                    {%- comment %}<locksmith:cbd4>{% endcomment -%}
                                      {%- capture var %}{% render 'locksmith-variables', scope: 'subject', subject: sublink, subject_parent: link, variable: 'transparent' %}{% endcapture %}{% if var == "true" %}{% else %}{% continue %}{% endif -%}
                                    {%- comment %}</locksmith:cbd4>{% endcomment -%}
                                    
                                    <div class="relative">
                                        {% if hasSubSubLinks %}<div class="font-bold px-4 py-2 uppercase">{{ sublink.title }}</div> 
                                        {% else %}
                                          
                                            <a href="{{ sublink.url }}" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 capitalise">
                                                        {{ sublink.title }}
                                                    </a>
                                        {% endif %}
                                        
                                        {% if sublink.links.size > 0 %}
                                            <div class="mt-2">
                                                {% for subsub in sublink.links %}
                                                    {%- comment %}<locksmith:a3e0>{% endcomment -%}
                                                      {%- capture var %}{% render 'locksmith-variables', scope: 'subject', subject: subsub, subject_parent: sublink, variable: 'transparent' %}{% endcapture %}{% if var == "true" %}{% else %}{% continue %}{% endif -%}
                                                    {%- comment %}</locksmith:a3e0>{% endcomment -%}
                                                    <a href="{{ subsub.url }}" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">
                                                        {{ subsub.title }}
                                                    </a>
                                                {% endfor %}
                                            </div>
                                        {% endif %}
                                    </div>
                                {% endfor %}

                                <!-- Desktop Nav Images -->
            
                              {% unless hasSubSubLinks %}</div>{% endunless %} 
                                {% if canHaveImage %}
                              {% for block in section.blocks %}
                                {% assign  linkTitleLowercase = link.title | downcase %}
                                {% assign  displayOnToLowerCase = block.settings.title | downcase %}
                              {% if linkTitleLowercase == displayOnToLowerCase %}
                              <div class="flex justify-end">
                                <div class="grid flex-1 gap-2 grid-cols-2">
                              
                                  <a class="relative" href="{{ block.settings.url }}">
                                    <div class="w-80 h-80 ">
                                      <div class="absolute left-0 top-0 dark-overlay w-80 h-80 z-10 bg-black opacity-10"></div>
                                      <picture>
                                        <img class="transition duration-100 ease-in-out opacity-100 aspect-square w-80 h-80 object-fill" src="{{ block.settings.image | img_url: "large" }}">
                                      </picture>
                                    </div>
                                    <div class="absolute bottom-2 p-4 z-20">
                                      <p class="text-white text-2xl font-bold">{{ block.settings.text }}</p>
                                    </div>
                                  </a>
                                  <a class="relative" href="{{ block.settings.url-2 }}">
                                    <div class="w-80 h-80">
                                      <div class="absolute left-0 top-0 dark-overlay w-80 h-80 z-10 bg-black opacity-10"></div>
                                      <picture>
                                        <img class="transition duration-100 ease-in-out opacity-100 aspect-square w-80 h-80 object-fill" src="{{ block.settings.image-2 | img_url: "large" }}">
                                      </picture>
                                    </div>
                                    <div class="absolute bottom-2 p-4 z-20">
                                      <p class="text-white text-2xl font-bold">{{ block.settings.text }}</p>
                                    </div>
                                  </a>
                                </div>
                              
                              </div>
                                {% endif %}
                                {% endfor %}
                            {% endif %}
                            <!-- ./Desktop Nav images -->
                             
                            </div>
                            
                          </div>
                        </div>
                      {% endif %}
                </div>
            {% endfor %}
        </div>
    </div>
</nav>

<script>
    function menuState() {
        return {
            open: false
        }
    }
</script>



{% schema %}
{
  "name": "Mega menu",
  "class": "section-header mega-menu",
  "enabled_on": {
    "groups": ["header"]
      },
  "settings": [
    {
      "type": "select",
      "id": "logo_position",
      "options": [
        {
          "value": "top-left",
          "label": "t:sections.header.settings.logo_position.options__2.label"
        },
        {
          "value": "top-center",
          "label": "t:sections.header.settings.logo_position.options__3.label"
        },
        {
          "value": "middle-left",
          "label": "t:sections.header.settings.logo_position.options__1.label"
        },
        {
          "value": "middle-center",
          "label": "t:sections.header.settings.logo_position.options__4.label"
        }
      ],
      "default": "middle-left",
      "label": "t:sections.header.settings.logo_position.label",
      "info": "t:sections.header.settings.logo_help.content"
    },
    {
      "type": "link_list",
      "id": "menu",
      "default": "main-menu",
      "label": "t:sections.header.settings.menu.label"
    },
    {
      "type": "select",
      "id": "menu_type_desktop",
      "options": [
        {
          "value": "dropdown",
          "label": "t:sections.header.settings.menu_type_desktop.options__1.label"
        },
        {
          "value": "mega",
          "label": "t:sections.header.settings.menu_type_desktop.options__2.label"
        },
        {
          "value": "drawer",
          "label": "t:sections.header.settings.menu_type_desktop.options__3.label"
        }
      ],
      "default": "dropdown",
      "label": "t:sections.header.settings.menu_type_desktop.label",
      "info": "t:sections.header.settings.menu_type_desktop.info"
    },
    {
      "type": "select",
      "id": "sticky_header_type",
      "options": [
        {
          "value": "none",
          "label": "t:sections.header.settings.sticky_header_type.options__1.label"
        },
        {
          "value": "on-scroll-up",
          "label": "t:sections.header.settings.sticky_header_type.options__2.label"
        },
        {
          "value": "always",
          "label": "t:sections.header.settings.sticky_header_type.options__3.label"
        },
        {
          "value": "reduce-logo-size",
          "label": "t:sections.header.settings.sticky_header_type.options__4.label"
        }
      ],
      "default": "on-scroll-up",
      "label": "t:sections.header.settings.sticky_header_type.label"
    },
    {
      "type": "checkbox",
      "id": "show_line_separator",
      "default": true,
      "label": "t:sections.header.settings.show_line_separator.label"
    },
    {
      "type": "select",
      "id": "color_scheme",
      "options": [
        {
          "value": "accent-1",
          "label": "t:sections.all.colors.accent_1.label"
        },
        {
          "value": "accent-2",
          "label": "t:sections.all.colors.accent_2.label"
        },
        {
          "value": "background-1",
          "label": "t:sections.all.colors.background_1.label"
        },
        {
          "value": "background-2",
          "label": "t:sections.all.colors.background_2.label"
        },
        {
          "value": "inverse",
          "label": "t:sections.all.colors.inverse.label"
        }
      ],
      "default": "background-1",
      "label": "t:sections.all.colors.label"
    },
    {
      "type": "header",
      "content": "t:sections.header.settings.header__3.content",
      "info": "t:sections.header.settings.header__4.info"
    },
    {
      "type": "checkbox",
      "id": "enable_country_selector",
      "default": false,
      "label": "t:sections.header.settings.enable_country_selector.label"
    },
    {
      "type": "header",
      "content": "t:sections.header.settings.header__5.content",
      "info": "t:sections.header.settings.header__6.info"
    },
    {
      "type": "checkbox",
      "id": "enable_language_selector",
      "default": false,
      "label": "t:sections.header.settings.enable_language_selector.label"
    },
    {
      "type": "header",
      "content": "t:sections.header.settings.mobile_layout.content"
    },
    {
      "type": "select",
      "id": "mobile_logo_position",
      "options": [
        {
          "value": "center",
          "label": "t:sections.header.settings.mobile_logo_position.options__1.label"
        },
        {
          "value": "left",
          "label": "t:sections.header.settings.mobile_logo_position.options__2.label"
        }
      ],
      "default": "center",
      "label": "t:sections.header.settings.mobile_logo_position.label"
    },
    {
      "type": "header",
      "content": "t:sections.all.spacing"
    },
    {
      "type": "range",
      "id": "margin_bottom",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "t:sections.header.settings.margin_bottom.label",
      "default": 0
    },
    {
      "type": "header",
      "content": "t:sections.all.padding.section_padding_heading"
    },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 36,
      "step": 4,
      "unit": "px",
      "label": "t:sections.all.padding.padding_top",
      "default": 20
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 36,
      "step": 4,
      "unit": "px",
      "label": "t:sections.all.padding.padding_bottom",
      "default": 20
    }
  ],
  "blocks": [
    {
      "type": "@app"
    },
    {
      "type": "desktop-nav-image",
      "name": "Destop Nav Image",
      "settings": [
        {
          "type": "text",
          "id": "title",
          "label": "link to display on",
          "default": "link"
        },
        {
          "type": "text",
          "id": "text",
          "label": "First Image text",
          "default": "Collection One"
        },
        {
          "type": "text",
          "id": "url",
          "label": "First Image url"
        },
        {
          "type": "image_picker",
          "id": "image",
          "label": "First image"
        },    
        {
          "type": "text",
          "id": "text-2",
          "label": "Secound Image text",
          "default": "Collection Two"
        },
        {
          "type": "text",
          "id": "url-2",
          "label": "Secound Image url"
        },
        {
          "type": "image_picker",
          "id": "image-2",
          "label": "Secound image"
          
        }    
      ]
    }
  ],
  "presets": [
      {
          "name": "Mega menu sections"
      }
    ]
}
{% endschema %}
