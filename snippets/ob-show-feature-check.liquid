{% assign market_code = localization.language.root_url %}
{% if market_code == '/' %}
  {% assign market_code = 'uk' %}
{% else %}
  {% assign market_code = market_code | remove: '/' %}
{% endif %}
{% assign object = shop.metaobjects.localisations[metaobject_handle] %}
{% assign show_on_all = object.show_on_all_markets %}
{% assign to_show_on = object.markets_to_show_on_ | replace: '[', ''| replace: '"', '' | replace: ']', '' | split: ',' %}
{% assign to_exclude_from = object.markets_to_exclude_from | replace: '[', ''| replace: '"', '' | replace: ']', '' | split: ',' %}
{% assign show = "true" %}
{% unless show_on_all %}
  {% if to_exclude_from != blank %}
    {% for market in to_exclude_from %}
      {% assign market_strip = market | strip %}
      {% assign market_downcase = market_strip | downcase %}
      {% if market_code == market_downcase %}
        {% assign show = "false" %}
        {% break %}
      {% endif %}
    {% endfor %}
  {% endif %}      
  {% if show == "true" %}
    {% assign show = "false" %}
    {% for market in to_show_on %}
      {% assign market_strip = market | strip %}
      {% assign market_downcase = market_strip | downcase %}
      {% if market_code == market_downcase %}
        {% assign show = "true" %}
        {% break %}
      {% endif %}
    {% endfor %}
  {% endif %}
{% endunless %}
{{ show }}